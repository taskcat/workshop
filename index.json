[{"uri":"/00_pre.html","title":"Prerequisites","tags":[],"description":"","content":" Prerequisites for the Workshop  Lab Enviornment   Getting Started   What you will need to get started! You will be porovided taskcat Workshop-Hash: b76bbe879be74e988678bb4a831365f3\nOpen a webrowser and navigate to https://dashboard.eventengine.run/\nEnter the Workshop-Hash to proceed\n"},{"uri":"/","title":"Taskcat Workshop","tags":[],"description":"","content":" taskcat workshop Whether authoring an AWS Quick Start or building an AWS Marketplace template to deploy your product on AWS, having confidence that your AWS CloudFormation templates are the best possible quality is key to wowing your customers. Learn to develop templates that are reliable, best practice, and portable across regions. In this workshop, we cover AWS CloudFormation best practices, tips on authoring AAA templates, and hands-on building of a CI/CD pipeline to validate templates before they are published.\nWhat you will learn  Using taskcat in your development environment to increase velocity while improving quality Some best practices for building highly portable and durable CloudFormation templates Using taskcat in a CI/CD workflow to ensure quality of releases  Architecture # TODO\n"},{"uri":"/00_pre/00_page1.html","title":"Lab Enviornment","tags":[],"description":"","content":" Lab information The AWS Appstream seesion that you are using for this hands on lab has the follow programs pre-installed:\n Python3 (taskcat is Python program) taskcat (pip install taskcat) Docker (Used for lambda packaging) Vscode (With taskcat schemea validation enabled)  "},{"uri":"/00_pre/00_page2.html","title":"Getting Started","tags":[],"description":"","content":" Getting Started "},{"uri":"/00_concepts.html","title":"Taskcat Concepts","tags":[],"description":"","content":" Config hierarchy Taskcat uses two config files: Global config and Project config\nProject Config This config file provides project-specific configurations.\nThe project config file is located in the root of your project folder \u0026lt;PROJECT_ROOT\u0026gt;/.taskcat.yml\nSince each lab uses the cfn-project directory as the project root, this is where our project-specific taskcat config file will reside.\nGlobal config This config file provides global settings that become defaults for all projects.\nThe global config file is located in user\u0026rsquo;s home-directory. ~/.taskcat.yml\nNote: The project-level configuration takes precedence over any items in the global config. However, Global parameters take precedence over project-level parameters. See below for more details.\nParameter Overrides Parameter Overrides were added to taskcat to solve a common problem: we didn\u0026rsquo;t want to add sensitive data (usernames, passwords, tokens) to a git repository. The idea was to store sensitive data outside of a git repository, but still execute a test using this data. To that end, any parameter defined in the global config will take precedence over the same parameter in a project-level config. We use this feature to ensure we\u0026rsquo;re using the appropraite S3 Buckets, keypairs, etc.\n(Psuedo) Parameters To increase the flexibility of taskcat, we\u0026rsquo;ve built in support for psuedo-parameters that are transposed at runtime for actual values.\n   Psuedo-Parameter Example Value passed to the CloudFormation stack Details     $[taskcat_autobucket] taskcat-tag-sample-taskcat-project-5fba6597 Note: The S3 Bucket is created   $[taskcat_genaz_1] \u0026ldquo;us-east-1a\u0026rdquo; Fetches a single Availability Zone within the region being launched in   $[taskcat_genaz_2] \u0026ldquo;us-east-1a,us-east-1b\u0026rdquo; Fetches two AvailabilityZones within the region being launched in   $[taskcat_genaz_3] \u0026ldquo;us-east-1a,us-east-1b,us-east-1c\u0026rdquo; Fetches three AvailabilityZones within the region being launched in   $[taskcat_genpass_8A] tI8zN3iX8 An alphanumberic 8-charater random password. The length is customizable.   $[taskcat_genpass_8S] mA5@cB5! An alphanumberic 8-charater random password. The length is customizable.   $[taskcat_random-string] yysuawpwubvotiqgwjcu Generates a random string   $[taskcat_random-numbers] 56188163597280820763 Generates random numbers.   $[taskcat_genuuid] 1c2e3483-2c99-45bb-801d-8af68a3b907b Generates a UUID    Usage examples:\ntests: mytest: template: templates/lab1.template.yaml regions: - us-east-1 parameters: S3BucketName: '$[taskcat_autobucket]'  "},{"uri":"/10_lab1.html","title":"Lab 1","tags":[],"description":"","content":" What you will do in this lab: Using the provided clouformation template build a taskcat config\n Hint: Consider cfn_project under start/lab1 as the root of your Cloudformation project\n "},{"uri":"/10_lab1/10_page2.html","title":"Add a (Project Level) config","tags":[],"description":"","content":" Project Config Ths config file provides project specific configuration.\nThe project config file is located in the root of your project folder \u0026lt;PROJECT_ROOT\u0026gt;/.taskcat.yml\nFrom the vscode file browser navigate to the lab1/,\nOpen that taskcat.yml\n Double click on the file to open them in the ide tabs\n @TODO Screen shoot need updated to show appstream "},{"uri":"/10_lab1/10_page3.html","title":"- Define project section","tags":[],"description":"","content":" Add a project section for the value of name: specify the name of the project folder\nproject: name: cfn-project  "},{"uri":"/10_lab1/10_page4.html","title":"- Defining tests","tags":[],"description":"","content":" Adding test definitions  Define a test called mytest and define the template location\n Specfiy path to your relative to you project root template: templates/lab1.template.yaml\n   Optionally you you can set the project_root to a diffrent location if need be:\n-p PROJECT_ROOT or --project-root PROJECT_ROOT\n tests: mytest: template: templates/lab1.template.yaml  "},{"uri":"/10_lab1/10_page5.html","title":"- Define regions","tags":[],"description":"","content":" Add regions to your test  The region: key is optional for tests by default region inherit from the global configuration (We will conver global configs later in this lab)  The region parameter takes a list of regions. When defined in a test, taskcat will limit test to those regions\nFor now only specifiy one region us-east-1\ntests: mytest: template: templates/lab1.template.yaml regions: - us-east-1  "},{"uri":"/10_lab1/10_page6.html","title":"- Define parameters","tags":[],"description":"","content":" Add a parameter section to the test  add the parameters: set the value of S3BucketName to $[taskcat_autobucket] This will evaulate to the bucket that taskcat creates during execution   Hint: Parameter vaules can be dynamically passed to a stack during creation when testing with taskcat. For example: By specifing $[taskcat_autobucket] as the value of S3BucketName we can instruct taskcat to replace value with the name of the bucket that will be created at runtime\n tests: mytest: template: templates/lab1.template.yaml regions: - us-east-1 parameters: S3BucketName: '$[taskcat_autobucket]'  "},{"uri":"/10_lab1/10_page8.html","title":"Lambda packaging","tags":[],"description":"","content":" Test staging From your vscode terminal change directory to your project root for lab1 (lab1/cfn-project)\nUnder cfn-project you will see the following files\ncfn-project ├── lambda_functions/source/GenRandom/ ├── templates/lab1.template.yaml └── .taskcat.yml  The provided template for lab1 uses lambda backed custom resource.\nsource/GenRandom contains the lambda source.\nWhen lambda source is detected taskcat will spin up a docker container and build the lambda zip file and then save it to lambda_functions/packages/ This zip file is referenced in our lambda function\n GenRandomLambda: Type: AWS::Lambda::Function Properties: Description: Lambda creates simple random string Handler: lambda_function.handler Runtime: python3.7 Role: !GetAtt 'LambdaExecutionRole.Arn' Timeout: 300 Code: S3Bucket: !Ref 'S3BucketName' S3Key: !Sub '${S3KeyPrefix}lambda_functions/packages/GenRandom/lambda.zip'  If you want to run packaging step on its own you can run taskcat package\nThis is optional, In the next step we will execute the taskcat test which will run packaging prior to test execution\n"},{"uri":"/10_lab1/10_page7.html","title":"Execute a taskcat test","tags":[],"description":"","content":" Start a test From the cfn-project dir run you taskcat testa\ntaskcat test run  Expected output: "},{"uri":"/10_lab1/10_page9.html","title":"View test results","tags":[],"description":"","content":" Test Results After the test completes you will see a new folder under cfn-project called taskcat_outputs\ncfn-project ├── lambda_functions ├── templates ├── .taskcat.yml └── taskcat_outputs/index.html \u0026lt; - (report)  open taskcat_outputs/index.html in the your web browser To see the test logs click the View Logs link\n"},{"uri":"/20_lab2.html","title":"Lab 2","tags":[],"description":"","content":" What you will do in this lab: Using the provided clouformation template build a taskcat config that uses psuedo-parameters\nWe will use override to inject a LicenseToken and dymamically inject AvailiblityZone values during testing\n Use taskcat overrides pass inputs into the stack that you do not want in the project_root/gitrepo (secrets like LicenseKeys or APITokens, etc)\n Use the psuedo-parameters can be used to inject region specfic value (like AvailiblityZones KeyPairNames AccessCIDRs, etc)\n  Hint: Consider cfn_project under start/lab2 as the root of your Cloudformation project\n"},{"uri":"/20_lab2/20_page1.html","title":"Create Psuedo Parameters","tags":[],"description":"","content":" Add Psuedo-Parameters to your project-level taskcat config  Edit your cfn_project/.taskcat.yml parameters to include psuedo-parameters. Please see the Taskcat Concepts section for more details on psuedo-parameters\n Note: Parameter values we want to override from the global config must still be defined within the project config. In our example, below, you see a placeholder value. This can be any string and has no other consequence.\n Example project config file:\nproject: name: cfn-project tests: mytest: template: templates/lab2.template.yaml regions: - us-east-1 parameters: S3BucketName: '$[taskcat_autobucket]' S3KeyPrefix: 'cfn-project/' LicenseToken: 'value-to-be-overriden-by-global-config' AvailablityZones: $[taskcat_genaz_2]   Add Psuedo-parameters to your global taskcat config.  Edit your  parameters to include psuedo-parameters.\n Note: For the purposes of this lab, we\u0026rsquo;ve created a shortcut (symlink) to the actual file\n Example global config file:\ngeneral: parameters: LicenseToken: 're:invent-2019-is-awesome'   "},{"uri":"/20_lab2/20_page2.html","title":"Execute a taskcat test","tags":[],"description":"","content":" Start a test From you vsode terminal change directory to your project root for lab2 (lab2/cfn-project)\nUnder cfn-project you will see the following files\ncfn-project ├── lambda_functions ├── templates └── .taskcat.yml  From the cfn-project dir run you taskcat testa\ntaskcat test run  Expected output: "},{"uri":"/20_lab2/20_page3.html","title":"Check Template Outputs","tags":[],"description":"","content":" Test Results After the test completes you will see a new folder under cfn-project called taskcat_outputs\ncfn-project ├── lambda_functions ├── templates ├── .taskcat.yml └── taskcat_outputs/index.html \u0026lt; - (report)  open taskcat_outputs/index.html in the your web browser To see the test logs click the View Logs link\n@TODO: MORE SCREENSHOTS OF TEMPLATE OUTPUTS\n"},{"uri":"/30_lab3.html","title":"Lab 3","tags":[],"description":"","content":" Testing in multiple regions An important part of building high-confidence CloudFormation is multi-region testing.\nIn this lab, we will see how taskcat can help uncover common issues when deploying in multiple regions.\nWe\u0026rsquo;ll start off by we will use the same template which builds a lambda backed customer resource.\nTo test this template we will add 2 more regions to the test definition.\n After running the test, we will see that the US-EAST-1 region deploys properly, while we receive failures in other regions.  Looking at the logs we can see that lambda source is not accessible from the other regions.\n We will then modify the our template to include a child-stack. This child stack will pre-stage the lambda source in each region.\n Finally, we\u0026rsquo;ll kick off our taskcat test again to validate the fix we implemented!\n   Hint: Consider cfn_project under start/lab3 as the root of your CloudFormation project\n "},{"uri":"/30_lab3/30_page1.html","title":"Add additional regions &amp; test","tags":[],"description":"","content":" Add more regions  Edit your lab3/cfn_project/.taskcat.yml parameters to include additional regions.\n Example project config file:\nproject: name: cfn-project tests: mytest: template: templates/lab3.template.yaml regions: - us-east-1 - us-east-2 - us-west-1 parameters: S3BucketName: '$[taskcat_autobucket]' S3KeyPrefix: 'cfn-project/' LicenseToken: 'MY-FAKE-LICENSE-KEY' AvailabilityZones: $[taskcat_genaz_2]   Test the new regions taskcat test run  Test Results After the test completes you will see a new folder under cfn-project called taskcat_outputs\ncfn-project ├── lambda_functions ├── templates ├── .taskcat.yml └── taskcat_outputs/index.html \u0026lt; - (report)  open taskcat_outputs/index.html in the your web browser To see the test logs click the View Logs link\n@TODO: SCREENSHOT OF A FAILURE (INDEX)\n@TODO: SCREENSHOT OF SPECIFIC LAMBDA S3 ERROR (IN CFN LOG OUTPUT)\n"},{"uri":"/30_lab3/30_page2.html","title":"Modify the template","tags":[],"description":"","content":" Modify In VSCode, edit the cfn_project/templates/lab3.template.yaml file. We\u0026rsquo;ll be adding the following snipplet to the Resources section of the template.\nCopyZipsTemplate: Type: AWS::CloudFormation::Stack Properties: TemplateURL: !Sub \u0026quot;https://${S3BucketName}.${AWS::Region}.amazonaws.com/${S3KeyPrefix}templates/copy-zips.template.yaml\u0026quot; Parameters: S3BucketName: !Ref S3BucketName S3KeyPrefix: !Ref S3KeyPrefix SourceObjects: \u0026quot;lambda_functions/packages/GenRandom/lambda.zip\u0026quot;  The full template should reflect the following:\nAWSTemplateFormatVersion: 2010-09-09 Parameters: S3BucketName: AllowedPattern: '^[0-9a-zA-Z]+([0-9a-zA-Z-]*[0-9a-zA-Z])*$' ConstraintDescription: \u0026gt;- Bucket name can include numbers, lowercase letters, uppercase letters, and hyphens (-). It cannot start or end with a hyphen (-). Description: \u0026gt;- S3 bucket name for assets. Bucket name can include numbers, lowercase letters, uppercase letters, and hyphens (-). It cannot start or end with a hyphen (-). Type: String S3KeyPrefix: AllowedPattern: '^[0-9a-zA-Z-/]*$' ConstraintDescription: \u0026gt;- Can include numbers, lowercase letters, uppercase letters, hyphens (-), and forward slash (/). Default: 'cfn-project/' Description: \u0026gt;- S3 key prefix where assets are located should end with forward slash (/). Type: String Resources: LambdaExecutionRole: Type: AWS::IAM::Role Properties: AssumeRolePolicyDocument: Version: '2012-10-17' Statement: - Effect: Allow Principal: Service: - lambda.amazonaws.com Action: - sts:AssumeRole Path: \u0026quot;/\u0026quot; Policies: - PolicyName: root PolicyDocument: Version: '2012-10-17' Statement: - Effect: Allow Action: - logs:* Resource: arn:aws:logs:*:*:* GenRandomLambda: Type: AWS::Lambda::Function Properties: Description: Lambda creates simple random string Handler: lambda_function.handler Runtime: python3.7 Role: !GetAtt 'LambdaExecutionRole.Arn' Timeout: 300 Code: S3Bucket: !Ref 'S3BucketName' S3Key: !Sub '${S3KeyPrefix}lambda_functions/packages/GenRandom/lambda.zip' StringGenerator: Type: Custom::RandomString Properties: ServiceToken: !GetAtt GenRandomLambda.Arn Length: 12 CopyZipsTemplate: Type: AWS::CloudFormation::Stack Properties: TemplateURL: !Sub \u0026quot;https://${S3BucketName}.${AWS::Region}.amazonaws.com/${S3KeyPrefix}templates/copy-zips.template.yaml\u0026quot; Parameters: S3BucketName: !Ref S3BucketName S3KeyPrefix: !Ref S3KeyPrefix SourceObjects: \u0026quot;lambda_functions/packages/GenRandom/lambda.zip\u0026quot; Outputs: GeneratedRandomString: Description: Generated Random String Value: !GetAtt StringGenerator.RandomString LicenseToken: Description: LicenseToken passed in via overrides Value: !Ref LicenseToken AvailabilityZones: Description: AvailabilityZones injected via $[taskcat_genaz_3] psuedo-parameter Value: !Join [ ',', !Ref 'AvailabilityZones' ]  "},{"uri":"/30_lab3/30_page3.html","title":"Test again &amp; verify!","tags":[],"description":"","content":" Test Results After the test completes you will see a new folder under cfn-project called taskcat_outputs\ncfn-project ├── lambda_functions ├── templates ├── .taskcat.yml └── taskcat_outputs/index.html \u0026lt; - (report)  open taskcat_outputs/index.html in the your web browser To see the test logs click the View Logs link\n"},{"uri":"/40_lab4.html","title":"Lab 4","tags":[],"description":"","content":" What you will do in this lab: In this lab we see how taskcat can be useful in testing an application. We will deploy a pre-configured application via cloudformation abd validate the functionality by trying out it out.\nWe will learn how to use taskcat to do a local deployment of our app and instruct taskcat not to delete the stack at completion using it as a test deployment tool\n"},{"uri":"/50_lab5.html","title":"Lab 5","tags":[],"description":"","content":" Setup CICD pipeline for your project In this lab, you will learn how to do continuous integration of your CloudFormation templates, by creating a CI/CD pipeline for your project.\nFollowing diagram shows what you will deploy in this lab. [TODO:Architecture-diagram-of-CI/CD-pipeline]\nThe CI/CD pipeline uses AWS Codepipeline and AWS Code Build services. AWS Codepipeline has a source action for AWS Code commit repository, and a build action uses AWS Code Build to run tests. The Code Build runs TaskCat to perform the tests, similar to how you run TaskCat locally on your laptop.\nAfter you have set-up a CI/CD pipeline for your project, next time you push any changes to your git repository, it will trigger the pipeline. This will run the tests you have defined in your project configuration file, and on successfull test, the changes will be promoted from source branch to the target/release branch.\nSo, let\u0026rsquo;s get started with setting-up a CICD pipeline.\n"},{"uri":"/50_lab5/10_page.html","title":"Deploy CI/CD pipeline","tags":[],"description":"","content":" To setup a CICD pipeline for your project, you need the following details. Make a note of the following before proceeding with the rest of the steps: -\n Your AWS Code Commit repository name Your AWS Code Commit repository Url (https://) Source branch name, where you will be pushing your changes Release branch name, where your changes needs to be promoted, after successfull test  Launch stack To create a CICD pipeline, you will use a CloudFormation template. Click the following button to launch a stack creation for the CICD pipeline. \nThis will open a CloudFormation console in a new tab in your browser, with CloudFormation template S3 path pre-populated.\nClick Next, and fill in the parameter values with the values you made a note of, earlier. Leave default values for Quick Start S3 Bucket Name and Quick Start S3 Key Prefix parameters.\nAfter you have provided all the parameter values, click Next, and Next again.\nOn the Review page, scroll down, select the checkboxes for IAM_CAPABILITIES and click Create stack.\nThis will start the stack creation. It will take approximately 5 mins to finish.\n"},{"uri":"/50_lab5/20_page.html","title":"View test and code promotion","tags":[],"description":"","content":" Now, after your stack creation is completed successfully and you have a CICD pipeline setup, let\u0026rsquo;s see what does the pipeline do.\nView CICD pipeline On your Cloudformation console, click the Outputs tab.\nLook for CodePipelineURL, and open the link in a new tab in your browser.\nThis will open the AWS Code Pipeline console, and you should see a pipeline.\nYou may see that, either the Source action or the Build action is in-progress. This is because, when the code pipeline is created for the first time, it automatically gets triggered and start the pipeline execution.\nThe Source action of the pipeline takes the code from the AWS Code Commit repository and puts it into an S3 bucket. This S3 bucket acts as a source for the next stage of the pipeline, which is Build stage.\nIn Build stage, pipeline is using AWS CodeBuild to run TaskCat for your project. It performs all the tests, as defined in the project configuration file. On success, it merges the source branch into the target/release branch.\nValidate code promotion After the pipeline execution is completed successfully, you should have all the changes committed to the source (develop) branch, available in target/release (master) branch. Let\u0026rsquo;s validate it.\nGo to your code commit repository by clicking the following link.\nCode Commit repo\nSelect the branch name from the top right corner, and you should see that your master branch has same commits as your develop branch.\n[TODO:Code commit repository]\nCongratulations!! You have successfully setup a CICD pipeliine for your CloudFormation project.\nSummary You learnt how to setup and use a CICD pipeline for your CloudFormation project, to continously test and deploy your CloudFormation templates.\n"},{"uri":"/60_lab5.html","title":"Lab 6","tags":[],"description":"","content":" Lab 6 stub "},{"uri":"/categories.html","title":"Categories","tags":[],"description":"","content":""},{"uri":"/tags.html","title":"Tags","tags":[],"description":"","content":""}]